# Railway Configuration
# This file configures Railway deployment for Laravel

# Build configuration
build:
  builder: NIXPACKS
  buildCommand: |
    composer install --no-dev --optimize-autoloader
    php artisan config:cache
    php artisan route:cache
    php artisan view:cache

# Deploy configuration
deploy:
  startCommand: php artisan serve --host=0.0.0.0 --port=$PORT
  healthcheckPath: /
  healthcheckTimeout: 100
  restartPolicyType: ON_FAILURE
  restartPolicyMaxRetries: 10

# Environment variables
env:
  APP_ENV: production
  APP_DEBUG: false
  APP_URL: https://diario-obras-production.up.railway.app
  DB_CONNECTION: pgsql
  DB_HOST: ${{RAILWAY_DATABASE_HOST}}
  DB_PORT: ${{RAILWAY_DATABASE_PORT}}
  DB_DATABASE: ${{RAILWAY_DATABASE_NAME}}
  DB_USERNAME: ${{RAILWAY_DATABASE_USER}}
  DB_PASSWORD: ${{RAILWAY_DATABASE_PASSWORD}}
  REDIS_URL: ${{RAILWAY_REDIS_URL}}